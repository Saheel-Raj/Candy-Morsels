<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Candy Morsels</title><style>body{background:url('https://static.vecteezy.com/system/resources/thumbnails/003/235/083/original/candyland-cartoon-background-free-video.jpg') center center / cover no-repeat fixed;
            font-family: 'Segoe UI', Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0;
            min-height: 100vh;
        }

        h1 {
            margin-top: 2rem;
            font-weight: 800;
            color: #4ea8de;
            letter-spacing: 2px;
        }

        #score {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: #22223b;
        }

        #timer {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: #e74c3c;
        }

        .box {
            padding: 8px;
            box-shadow: 0 4px 24px rgba(78, 168, 222, 0.10);
            background: linear-gradient(90deg, #bccbf6 0%, #bccbf6 50%, #c69ef2 100%);
            border-radius: 20px;            
        }



        .grid {
            display: grid;
            grid-template-columns: repeat(8, 40px);
            grid-template-rows: repeat(8, 40px);
            gap: 2px;
            background: rgba(241, 237, 237, 0.843);
            border-radius: 18px;
            padding: 8px;
        }

        .restart {
            margin-top: 15px;
            padding: 10px 18px;
            color: #fff;
            background-color: #f83122;
            text-decoration: none;
            font-size: 18px;
            border-radius: 10px;
            cursor: pointer;
        }

        .candy {
            width: 40px;
            height: auto;
            border-radius: 10px;
            background-size: cover;
            cursor: pointer;
            transition: transform 0.3s;
        }


        .candy:active {
            transform: scale(1.1) translateY(1px);
        }

        /* 
        .candy.selected {
            transform: scale(1.05);
        } */

        .candy.pop {
            animation: pop 420ms forwards;
        }

        @keyframes pop {
            0% {
                transform: scale(1);
                opacity: 1;
            }

            50% {
                transform: scale(1.4);
                opacity: 0.9;
            }

            100% {
                transform: scale(0);
                opacity: 0;
            }
        }

        footer {
            color: #ffffff5a;
        }

        footer:hover{
            color: #000;
        }
    </style>
</head>

<body>
    <h1>Candy Morsels</h1>
    <div id="score">Score: 0</div>
    <div id="timer">Time Left: 60s</div>
    <div class="box">
        <div class="grid" id="grid"></div>
    </div>
    <div class="restart"><a onclick="window.location.reload()">Restart</a></div>
    <footer>Coding by Saheel Raj Prasad X'D'</footer>

    <script>

        console.log("Hello World!");

        const grid = document.getElementById('grid');
        const scoreDisplay = document.getElementById('score');
        const timerDisplay = document.getElementById('timer');
        const width = 8;
        const candyImages = ['red.png', 'blue.png', 'yellow.png', 'green.png', 'purple.png', 'brown.png'];
        let squares = [];
        let score = 0;
        let selectedCandy = null;
        let timeLeft = 60; // Timer in seconds

        // Create the game board
        function createBoard() {
            for (let i = 0; i < width * width; i++) {
                const square = document.createElement('div');
                square.classList.add('candy');
                square.setAttribute('data-id', i);
                square.style.backgroundImage = `url(${getValidCandy(i)})`;
                grid.appendChild(square);
                squares.push(square);
            }
            checkMatches(); // Check for initial matches and eliminate them
        }

        // Get a random candy image
        function getRandomCandy() {
            return candyImages[Math.floor(Math.random() * candyImages.length)];
        }

        // Get a valid candy image that doesn't create immediate matches
        function getValidCandy(index) {
            let candy;
            do {
                candy = getRandomCandy();
            } while (createsMatch(index, candy));
            return candy;
        }

        // Check if placing a candy at the given index creates a match
        function createsMatch(index, candy) {
            const rowStart = Math.floor(index / width) * width;
            const colStart = index % width;

            // Check row match
            if (colStart >= 2 && candy === squares[index - 1]?.style.backgroundImage && candy === squares[index - 2]?.style.backgroundImage) {
                return true;
            }

            // Check column match
            if (index >= width * 2 && candy === squares[index - width]?.style.backgroundImage && candy === squares[index - width * 2]?.style.backgroundImage) {
                return true;
            }

            return false;
        }

        // Handle candy selection and swapping
        function handleCandyClick(e) {
            const clickedCandy = e.target;
            const clickedIndex = parseInt(clickedCandy.getAttribute('data-id'));

            if (!selectedCandy) {
                // Select the candy
                selectedCandy = clickedCandy;
                selectedCandy.style.outline = '3px solid #b352d1';
            } else {
                // Swap candies if adjacent
                const selectedIndex = parseInt(selectedCandy.getAttribute('data-id'));
                if (isAdjacent(selectedIndex, clickedIndex)) {
                    swapCandies(selectedCandy, clickedCandy);
                    checkMatches();
                }
                // Deselect the candy
                selectedCandy.style.outline = '';
                selectedCandy = null;
            }
        }

        // Check if two candies are adjacent
        function isAdjacent(index1, index2) {
            return Math.abs(index1 - index2) === 1 || Math.abs(index1 - index2) === width;
        }

        // Swap two candies
        function swapCandies(candy1, candy2) {
            const temp = candy1.style.backgroundImage;
            candy1.style.backgroundImage = candy2.style.backgroundImage;
            candy2.style.backgroundImage = temp;
        }

        // Check for matches (3 in a row or column)
        function checkMatches() {
            let matched = false;

            // Check rows and columns
            for (let i = 0; i < width * width; i++) {
                const candy = squares[i].style.backgroundImage;

                // Check row matches (3 candies)
                if (i % width < width - 2 && candy === squares[i + 1]?.style.backgroundImage && candy === squares[i + 2]?.style.backgroundImage) {
                    matched = true;
                    clearCandies([i, i + 1, i + 2]);
                }

                // Check column matches (3 candies)
                if (i < width * (width - 2) && candy === squares[i + width]?.style.backgroundImage && candy === squares[i + width * 2]?.style.backgroundImage) {
                    matched = true;
                    clearCandies([i, i + width, i + width * 2]);
                }
            }

            if (matched) {
                score += 10; // Increase score for matches
                scoreDisplay.textContent = `Score: ${score}`;
                setTimeout(() => {
                    dropCandies();
                    setTimeout(checkMatches, 300); // Recheck matches after candies drop
                }, 300);
            }
        }

        // Clear matched candies
        function clearCandies(indices) {
            indices.forEach(index => {
                squares[index].classList.add('pop');
                setTimeout(() => {
                    squares[index].style.backgroundImage = '';
                    squares[index].classList.remove('pop');
                }, 300);
            });
        }

        // Drop candies to fill empty spaces
        function dropCandies() {
            let moved = false;

            for (let i = width * (width - 1) - 1; i >= 0; i--) {
                if (squares[i + width]?.style.backgroundImage === '') {
                    squares[i + width].style.backgroundImage = squares[i].style.backgroundImage;
                    squares[i].style.backgroundImage = '';
                    moved = true;
                }
            }

            for (let i = 0; i < width; i++) {
                if (squares[i].style.backgroundImage === '') {
                    squares[i].style.backgroundImage = `url(${getRandomCandy()})`;
                    moved = true;
                }
            }

            // Ensure candies drop until no spaces remain
            if (moved) {
                setTimeout(dropCandies, 80);
            }
        }

        // Timer logic
        function startTimer() {
            const timerInterval = setInterval(() => {
                timeLeft--;
                timerDisplay.textContent = `Time Left: ${timeLeft}s`;

                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    alert(`Game Over! Your score: ${score}`);
                }
            }, 1000);
        }

        // Initialize the game
        createBoard();
        squares.forEach(square => square.addEventListener('click', handleCandyClick));
        startTimer();
    </script>
</body>

</html>